<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KitchenVibe Ghost Kitchen</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #fff;
        }
        canvas {
            display: block;
            width: 100vw !important;
            height: 100vh !important;
        }
        #ui-menu {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            color: #fff;
            font-family: Arial, sans-serif;
            z-index: 10;
        }
        #ui-menu button {
            display: block;
            margin: 5px 0;
            padding: 8px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #ui-menu button:hover {
            background: #555;
        }
        #shop-menu, #shipping-form, #about-info {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            font-family: Arial, sans-serif;
            max-width: 400px;
            z-index: 10;
        }
        #shop-menu button, #shipping-form button, #about-info button {
            padding: 8px;
            margin: 5px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #shop-menu button:hover, #shipping-form button:hover, #about-info button:hover {
            background: #555;
        }
        #shipping-form input {
            display: block;
            margin: 10px 0;
            padding: 5px;
            width: 200px;
        }
        #cart-items div {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
        }
        @media (max-width: 768px) {
            canvas {
                width: 100vw !important;
                height: 100vh !important;
            }
            #ui-menu, #shop-menu, #shipping-form, #about-info {
                top: 5px;
                left: 5px;
                font-size: 12px;
                width: 90%;
                transform: none;
            }
            #ui-menu button, #shop-menu button, #shipping-form button, #about-info button {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div id="ui-menu">
        <button onclick="switchView('home')">Home</button>
        <button onclick="switchView('about')">About</button>
        <button onclick="switchView('shop')">Shop</button>
        <button onclick="switchView('checkout')">Checkout</button>
    </div>
    <div id="shop-menu">
        <h2>Menu</h2>
        <button onclick="addToCart('Burger', 8.99)">Add Burger ($8.99)</button>
        <button onclick="addToCart('Pizza', 12.99)">Add Pizza ($12.99)</button>
        <button onclick="addToCart('Salad', 6.99)">Add Salad ($6.99)</button>
    </div>
    <div id="shipping-form">
        <h2>Checkout</h2>
        <div id="cart-items"></div>
        <input type="text" placeholder="Name" />
        <input type="text" placeholder="Address" />
        <input type="text" placeholder="City" />
        <input type="text" placeholder="Zip Code" />
        <button onclick="alert('Order Submitted!'); cart = []; updateCart()">Submit Order</button>
    </div>
    <div id="about-info">
        <h2>About KitchenVibe Ghost Kitchen</h2>
        <p>We are a premier ghost kitchen specializing in delicious, made-to-order meals delivered straight to your door. Our state-of-the-art kitchen ensures efficiency and quality, using the freshest ingredients to create culinary delights. Contact us at info@kitchenvibe.com.</p>
        <button onclick="document.getElementById('about-info').style.display = 'none'">Close</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/OrbitControls.js"></script>
    <script>
        // Template Data
        const templateData = {
            name: "KitchenVibe Ghost Kitchen Template",
            description: "A minimalist 3D ghost kitchen template optimized for online food businesses, featuring a streamlined layout with a large make table, a stainless steel stove and fridge along the back wall, a single vent hood unit with integrated lights, a side counter with a large stainless steel sink and faucet against the right wall, a computer desk with register and card scanner, and a shop/checkout system with placeholder menu items. Enhanced with improved lighting, larger logo on the front wall, and optimized rendering for mobile browsers.",
            features: [
                "Large wooden make table, free of appliances, centered for prep",
                "Stainless steel stove (4x0.9x1m) with matching fridge, both with reflective texture, along back wall",
                "Sleek fridge with door and handle",
                "Side counter with large stainless steel sink and modern faucet against right wall",
                "Desk with computer, register, and card scanner for online orders",
                "Single vent hood unit with integrated recessed lights",
                "Shop menu with add-to-cart functionality and checkout with remove buttons",
                "Enhanced lighting with sink spotlight and optimized shadows",
                "Larger logo with modern font on front wall",
                "Optimized for mobile browsers with 1K textures and reduced polygons"
            ],
            about: {
                title: "About KitchenVibe Ghost Kitchen",
                content: "We are a premier ghost kitchen specializing in delicious, made-to-order meals delivered straight to your door. Our state-of-the-art kitchen ensures efficiency and quality, using the freshest ingredients to create culinary delights. Contact us at info@kitchenvibe.com."
            }
        };

        // Cart Management
        let cart = [];
        function addToCart(item, price) {
            cart.push({ item, price });
            updateCart();
        }
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
        }
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = '';
            cart.forEach((entry, index) => {
                const div = document.createElement('div');
                div.innerHTML = `${entry.item} - $${entry.price.toFixed(2)} <button onclick="removeFromCart(${index})">Remove</button>`;
                cartItems.appendChild(div);
            });
        }

        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5)); // Optimized for mobile
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);

        // OrbitControls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.screenSpacePanning = false;
        controls.minDistance = 2;
        controls.maxDistance = 15;
        controls.maxPolarAngle = Math.PI / 2;
        controls.target.set(0, 1, 0);

        // Environment Map for Subtle Reflections
        const cubeTextureLoader = new THREE.CubeTextureLoader();
        const envMap = cubeTextureLoader.load([
            'https://threejs.org/examples/textures/cube/Bridge2/posx.jpg',
            'https://threejs.org/examples/textures/cube/Bridge2/negx.jpg',
            'https://threejs.org/examples/textures/cube/Bridge2/posy.jpg',
            'https://threejs.org/examples/textures/cube/Bridge2/negy.jpg',
            'https://threejs.org/examples/textures/cube/Bridge2/posz.jpg',
            'https://threejs.org/examples/textures/cube/Bridge2/negz.jpg'
        ]);
        scene.environment = envMap;

        // Enhanced Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); // Slightly brighter
        scene.add(ambientLight);
        const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.6);
        directionalLight1.position.set(5, 5, 5);
        directionalLight1.castShadow = true;
        directionalLight1.shadow.mapSize.width = 512;
        directionalLight1.shadow.mapSize.height = 512;
        scene.add(directionalLight1);
        const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
        directionalLight2.position.set(-5, 5, -5);
        directionalLight2.castShadow = true;
        directionalLight2.shadow.mapSize.width = 256; // Reduced for mobile
        directionalLight2.shadow.mapSize.height = 256;
        scene.add(directionalLight2);
        // Stove Lights
        const stoveLight1 = new THREE.PointLight(0xffffff, 1.5, 5);
        stoveLight1.position.set(-1, 2.35, -4);
        stoveLight1.castShadow = true;
        stoveLight1.shadow.mapSize.width = 512;
        stoveLight1.shadow.mapSize.height = 512;
        scene.add(stoveLight1);
        const stoveLight2 = new THREE.PointLight(0xffffff, 1.5, 5);
        stoveLight2.position.set(1, 2.35, -4);
        stoveLight2.castShadow = true;
        stoveLight2.shadow.mapSize.width = 512;
        stoveLight2.shadow.mapSize.height = 512;
        scene.add(stoveLight2);
        // Sink Light
        const sinkLight = new THREE.PointLight(0xffffff, 1.0, 5);
        sinkLight.position.set(4, 2.5, 0);
        scene.add(sinkLight); // No shadows for performance

        // Texture Loader
        const textureLoader = new THREE.TextureLoader();

        // Floor (ceramic tiles)
        const floorMaterial = new THREE.MeshStandardMaterial({
            color: 0xaaaaaa,
            roughness: 0.2,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
            // Suggested texture: https://polyhaven.com/a/white_ceramic_tiles_1k
        });
        const floorGeometry = new THREE.PlaneGeometry(10, 10);
        const floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -Math.PI / 2;
        floor.receiveShadow = true;
        scene.add(floor);

        // Walls (subway tiles)
        const wallMaterial = new THREE.MeshStandardMaterial({
            color: 0xffffff,
            roughness: 0.15,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
        });
        const wall1 = new THREE.Mesh(new THREE.PlaneGeometry(10, 5), wallMaterial);
        wall1.position.set(0, 2.5, -5);
        wall1.receiveShadow = true;
        scene.add(wall1);
        const wall2 = new THREE.Mesh(new THREE.PlaneGeometry(10, 5), wallMaterial);
        wall2.position.set(-5, 2.5, 0);
        wall2.rotation.y = Math.PI / 2;
        wall2.receiveShadow = true;
        scene.add(wall2);
        const wall3 = new THREE.Mesh(new THREE.PlaneGeometry(10, 5), wallMaterial);
        wall3.position.set(0, 2.5, 5);
        wall3.receiveShadow = true;
        scene.add(wall3);

        // Kitchen Logo (Front Wall, Larger, Cooler Font)
        const logoCanvas = document.createElement('canvas');
        logoCanvas.width = 1024;
        logoCanvas.height = 256;
        const logoContext = logoCanvas.getContext('2d');
        logoContext.fillStyle = '#ffffff';
        logoContext.fillRect(0, 0, logoCanvas.width, logoCanvas.height);
        logoContext.font = 'bold 150px Montserrat, sans-serif';
        logoContext.fillStyle = '#333333';
        logoContext.textAlign = 'center';
        logoContext.textBaseline = 'middle';
        logoContext.fillText('KitchenVibe', logoCanvas.width / 2, logoCanvas.height / 2 - 50);
        logoContext.font = 'bold 80px Montserrat, sans-serif';
        logoContext.fillText('Ghost Kitchen', logoCanvas.width / 2, logoCanvas.height / 2 + 50);
        const logoTexture = new THREE.CanvasTexture(logoCanvas);
        const logoGeometry = new THREE.PlaneGeometry(4, 1);
        const logoMaterial = new THREE.MeshBasicMaterial({
            map: logoTexture,
            transparent: true
        });
        const logo = new THREE.Mesh(logoGeometry, logoMaterial);
        logo.position.set(0, 3, 4.9); // Front wall
        logo.rotation.y = -Math.PI / 2; // Face scene
        scene.add(logo);

        // Make Table (Respaced)
        const tableGeometry = new THREE.BoxGeometry(4, 0.1, 2, 6, 6, 6); // Reduced segments
        const tableMaterial = new THREE.MeshStandardMaterial({
            color: 0x8b5e3c,
            roughness: 0.3,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
            // Suggested texture: https://polyhaven.com/a/oak_wood_1k
        });
        const table = new THREE.Mesh(tableGeometry, tableMaterial);
        table.position.set(0, 0.9, 0); // Centered
        table.castShadow = true;
        table.receiveShadow = true;
        scene.add(table);
        const legGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.8, 8);
        const legs = [
            { pos: [1.8, 0.4, 0.9] },
            { pos: [1.8, 0.4, -0.9] },
            { pos: [-1.8, 0.4, 0.9] },
            { pos: [-1.8, 0.4, -0.9] }
        ];
        legs.forEach(l => {
            const leg = new THREE.Mesh(legGeometry, tableMaterial);
            leg.position.set(...l.pos);
            leg.castShadow = true;
            scene.add(leg);
        });

        // Stainless Steel Material (Enhanced for Stove and Fridge)
        const stainlessSteelMaterial = new THREE.MeshStandardMaterial({
            color: 0xd0d0d0,
            roughness: 0.2, // Slight reflection
            metalness: 0.9,
            envMap: envMap,
            envMapIntensity: 0.4
            // Suggested texture: https://polyhaven.com/a/metal_brushed_1k
        });

        // Fridge (Back Wall, Original with Door)
        const fridgeGeometry = new THREE.BoxGeometry(1, 2, 0.8, 6, 6, 6);
        const fridge = new THREE.Mesh(fridgeGeometry, stainlessSteelMaterial);
        fridge.position.set(-3, 1, -4);
        fridge.castShadow = true;
        scene.add(fridge);
        const fridgeDoorGeometry = new THREE.BoxGeometry(0.95, 1.9, 0.05, 6, 6, 6);
        const fridgeDoor = new THREE.Mesh(fridgeDoorGeometry, stainlessSteelMaterial);
        fridgeDoor.position.set(-3, 1, -3.575);
        scene.add(fridgeDoor);
        const handleGeometry = new THREE.CylinderGeometry(0.02, 0.02, 1.2, 8);
        const fridgeHandle = new THREE.Mesh(handleGeometry, stainlessSteelMaterial);
        fridgeHandle.position.set(-2.8, 1, -3.55);
        scene.add(fridgeHandle);

        // Stove (Back Wall, Matching Fridge)
        const stoveGeometry = new THREE.BoxGeometry(4, 0.9, 1, 6, 6, 6);
        const stove = new THREE.Mesh(stoveGeometry, stainlessSteelMaterial);
        stove.position.set(0, 0.45, -4);
        stove.castShadow = true;
        scene.add(stove);
        const stoveTopGeometry = new THREE.BoxGeometry(4, 0.05, 1, 6, 6, 6);
        const stoveTopMaterial = new THREE.MeshStandardMaterial({
            color: 0x1a1a1a,
            roughness: 0.2,
            metalness: 0.9,
            envMap: envMap,
            envMapIntensity: 0.3
        });
        const stoveTop = new THREE.Mesh(stoveTopGeometry, stoveTopMaterial);
        stoveTop.position.set(0, 0.925, -4);
        scene.add(stoveTop);
        const burnerGeometry = new THREE.CylinderGeometry(0.15, 0.15, 0.02, 8);
        const burnerMaterial = new THREE.MeshStandardMaterial({
            color: 0x222222,
            roughness: 0.3,
            metalness: 0.8,
            envMap: envMap,
            envMapIntensity: 0.3
        });
        const burners = [
            { pos: [-1.2, 0.95, -4] }, // Fixed to stovetop
            { pos: [-0.4, 0.95, -4] },
            { pos: [0.4, 0.95, -4] },
            { pos: [1.2, 0.95, -4] }
        ];
        burners.forEach(b => {
            const burner = new THREE.Mesh(burnerGeometry, burnerMaterial);
            burner.position.set(...b.pos);
            burner.rotation.x = Math.PI / 2;
            burner.castShadow = true;
            scene.add(burner);
        });
        const knobGeometry = new THREE.CylinderGeometry(0.03, 0.03, 0.02, 8);
        const knobs = [
            { pos: [-1.2, 0.925, -3.45] },
            { pos: [-0.4, 0.925, -3.45] },
            { pos: [0.4, 0.925, -3.45] },
            { pos: [1.2, 0.925, -3.45] }
        ];
        knobs.forEach(k => {
            const knob = new THREE.Mesh(knobGeometry, stainlessSteelMaterial);
            knob.position.set(...k.pos);
            knob.rotation.x = Math.PI / 2;
            knob.castShadow = true;
            scene.add(knob);
        });

        // Single Vent Hood Unit
        const hoodGeometry = new THREE.BoxGeometry(4, 0.3, 0.8, 6, 6, 6);
        const hood = new THREE.Mesh(hoodGeometry, stainlessSteelMaterial);
        hood.position.set(0, 2.5, -4);
        hood.castShadow = true;
        scene.add(hood);
        const chimneyGeometry = new THREE.BoxGeometry(0.8, 0.8, 0.5);
        const chimney = new THREE.Mesh(chimneyGeometry, stainlessSteelMaterial);
        chimney.position.set(0, 3, -4);
        scene.add(chimney);

        // Side Counter with Sink (Right Wall)
        const sideCounterGeometry = new THREE.BoxGeometry(1, 0.1, 4, 6, 6, 6);
        const counterMaterial = new THREE.MeshStandardMaterial({
            color: 0xe0e0e0,
            roughness: 0.15,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
            // Suggested texture: https://polyhaven.com/a/quartzite_1k
        });
        const sideCounter = new THREE.Mesh(sideCounterGeometry, counterMaterial);
        sideCounter.position.set(4, 0.9, 0);
        sideCounter.rotation.y = Math.PI / 2;
        sideCounter.receiveShadow = true;
        scene.add(sideCounter);
        const sideCabinetGeometry = new THREE.BoxGeometry(1, 0.9, 4, 6, 6, 6);
        const cabinetMaterial = new THREE.MeshStandardMaterial({
            color: 0x4a3728,
            roughness: 0.3,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
        });
        const sideCabinet = new THREE.Mesh(sideCabinetGeometry, cabinetMaterial);
        sideCabinet.position.set(4, 0.45, 0);
        sideCabinet.rotation.y = Math.PI / 2;
        sideCabinet.castShadow = true;
        scene.add(sideCabinet);
        // Fixed Sink
        const sinkGeometry = new THREE.BoxGeometry(1.2, 0.1, 0.6, 6, 6, 6);
        const sink = new THREE.Mesh(sinkGeometry, stainlessSteelMaterial);
        sink.position.set(4, 0.9, 1);
        sink.rotation.y = Math.PI / 2;
        scene.add(sink);
        // Enhanced Faucet
        const faucetBaseGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.1, 8);
        const faucetBase = new THREE.Mesh(faucetBaseGeometry, stainlessSteelMaterial);
        faucetBase.position.set(4, 1.0, 1.35);
        scene.add(faucetBase);
        const faucetPipeGeometry = new THREE.CylinderGeometry(0.02, 0.02, 0.4, 8);
        const faucetPipe = new THREE.Mesh(faucetPipeGeometry, stainlessSteelMaterial);
        faucetPipe.position.set(4, 1.15, 1.2);
        faucetPipe.rotation.x = Math.PI / 4;
        scene.add(faucetPipe);
        const faucetNozzleGeometry = new THREE.CylinderGeometry(0.03, 0.03, 0.05, 8);
        const faucetNozzle = new THREE.Mesh(faucetNozzleGeometry, stainlessSteelMaterial);
        faucetNozzle.position.set(4, 1.25, 1.15);
        faucetNozzle.rotation.x = Math.PI / 4;
        scene.add(faucetNozzle);

        // Desk (Respaced)
        const deskGeometry = new THREE.BoxGeometry(1.5, 0.1, 0.8, 6, 6, 6);
        const deskMaterial = new THREE.MeshStandardMaterial({
            color: 0x4a3728,
            roughness: 0.3,
            metalness: 0.05,
            envMap: envMap,
            envMapIntensity: 0.1
        });
        const desk = new THREE.Mesh(deskGeometry, deskMaterial);
        desk.position.set(4, 0.8, -2);
        desk.castShadow = true;
        scene.add(desk);
        const deskLegGeometry = new THREE.CylinderGeometry(0.05, 0.05, 0.7, 8);
        const deskLegs = [
            { pos: [4.6, 0.35, -1.7] },
            { pos: [4.6, 0.35, -2.3] },
            { pos: [3.4, 0.35, -1.7] },
            { pos: [3.4, 0.35, -2.3] }
        ];
        deskLegs.forEach(l => {
            const leg = new THREE.Mesh(deskLegGeometry, deskMaterial);
            leg.position.set(...l.pos);
            leg.castShadow = true;
            scene.add(leg);
        });
        const monitorGeometry = new THREE.BoxGeometry(0.5, 0.3, 0.05, 6, 6, 6);
        const monitorMaterial = new THREE.MeshStandardMaterial({
            color: 0x333333,
            roughness: 0.3,
            metalness: 0.7,
            envMap: envMap,
            envMapIntensity: 0.3
        });
        const monitor = new THREE.Mesh(monitorGeometry, monitorMaterial);
        monitor.position.set(4, 1.05, -2);
        monitor.rotation.y = -Math.PI / 4;
        scene.add(monitor);
        const screenGeometry = new THREE.PlaneGeometry(0.4, 0.25);
        const screenMaterial = new THREE.MeshBasicMaterial({
            color: 0x000000,
            opacity: 0.8,
            transparent: true
        });
        const screen = new THREE.Mesh(screenGeometry, screenMaterial);
        screen.position.set(4, 1.05, -1.974);
        screen.rotation.y = -Math.PI / 4;
        scene.add(screen);
        const keyboardGeometry = new THREE.BoxGeometry(0.4, 0.05, 0.15, 6, 6, 6);
        const keyboard = new THREE.Mesh(keyboardGeometry, monitorMaterial);
        keyboard.position.set(4, 0.85, -1.8);
        keyboard.rotation.y = -Math.PI / 4;
        scene.add(keyboard);
        const cardScannerGeometry = new THREE.BoxGeometry(0.15, 0.1, 0.1, 6, 6, 6);
        const cardScanner = new THREE.Mesh(cardScannerGeometry, monitorMaterial);
        cardScanner.position.set(4.25, 0.85, -1.8);
        cardScanner.rotation.y = -Math.PI / 4;
        scene.add(cardScanner);

        // Camera Presets (Updated Shop Angle)
        const cameraPositions = {
            home: { pos: [5, 2.5, -3], target: [0, 1, 0], overlay: null }, // Wide view
            about: { pos: [2, 2.5, -2], target: [0, 3, 4.9], overlay: 'about-info' }, // Logo focus
            shop: { pos: [-3, 2, -5], target: [0, 0.9, -4], overlay: 'shop-menu' }, // Pulled-back stove view
            checkout: { pos: [5, 1.5, -1], target: [4, 0.8, -2], overlay: 'shipping-form' } // Desk focus
        };

        // View Switch Function
        function switchView(view) {
            const { pos, target, overlay } = cameraPositions[view];
            camera.position.set(...pos);
            controls.target.set(...target);
            controls.update();
            document.getElementById('shop-menu').style.display = overlay === 'shop-menu' ? 'block' : 'none';
            document.getElementById('shipping-form').style.display = overlay === 'shipping-form' ? 'block' : 'none';
            document.getElementById('about-info').style.display = overlay === 'about-info' ? 'block' : 'none';
        }

        // Initial View
        switchView('home');

        // Animation loop
        let time = 0;
        function animate() {
            requestAnimationFrame(animate);
            time += 0.01;
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
