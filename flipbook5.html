<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced PDF Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        #viewerContainer {
            width: 100%;
            max-width: 800px;
            height: 80vh;
            overflow: auto;
            background-color: #fff;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin: 20px;
            position: relative;
            overscroll-behavior: contain;
        }

        .page {
            margin: 10px auto;
            border: 1px solid #ddd;
            transition: transform 0.3s ease;
        }

        .page canvas {
            display: block;
            width: 100% !important;
            height: auto !important;
        }

        #controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 10px;
            background-color: #2c3e50;
            width: 100%;
            max-width: 800px;
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, background 0.3s;
        }

        button:hover {
            background: linear-gradient(45deg, #2980b9, #3498db);
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        #zoomLevel {
            padding: 10px;
            border-radius: 25px;
            border: 1px solid #ddd;
            font-size: 16px;
        }

        /* Mobile Optimization */
        @media (max-width: 600px) {
            #viewerContainer {
                height: 85vh;
                margin: 10px;
            }

            #controls {
                flex-wrap: wrap;
                gap: 5px;
                padding: 5px;
            }

            button {
                padding: 8px 15px;
                font-size: 14px;
            }

            #zoomLevel {
                width: 80px;
                font-size: 14px;
            }
        }

        /* Smooth page transition */
        .page-slide {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div id="controls">
        <button id="prev">Previous</button>
        <button id="next">Next</button>
        <select id="zoomLevel">
            <option value="0.5">50%</option>
            <option value="0.75">75%</option>
            <option value="1" selected>100%</option>
            <option value="1.25">125%</option>
            <option value="1.5">150%</option>
            <option value="2">200%</option>
        </select>
        <button id="zoomIn">Zoom In</button>
        <button id="zoomOut">Zoom Out</button>
    </div>
    <div id="viewerContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        let pdfDoc = null;
        let pageNum = 1;
        let pageRendering = false;
        let pageNumPending = null;
        let scale = 1;
        const viewerContainer = document.getElementById('viewerContainer');

        // Load PDF
        const url = 'sample.pdf'; // Replace with your PDF file path or URL
        pdfjsLib.getDocument(url).promise.then(pdf => {
            pdfDoc = pdf;
            renderPage(pageNum);
        }).catch(err => {
            console.error('Error loading PDF:', err);
            viewerContainer.innerHTML = '<p>Error loading PDF. Please check the file path.</p>';
        });

        function renderPage(num) {
            pageRendering = true;
            pdfDoc.getPage(num).then(page => {
                const viewport = page.getViewport({ scale });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                canvas.className = 'page';

                const renderContext = {
                    canvasContext: context,
                    viewport: viewport
                };
                const renderTask = page.render(renderContext);
                renderTask.promise.then(() => {
                    viewerContainer.innerHTML = ''; // Clear previous page
                    viewerContainer.appendChild(canvas);
                    pageRendering = false;
                    if (pageNumPending !== null) {
                        renderPage(pageNumPending);
                        pageNumPending = null;
                    }
                });

                // Smooth slide transition
                canvas.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    canvas.style.transform = 'translateX(0)';
                }, 10);
            });
        }

        function queueRenderPage(num) {
            if (pageRendering) {
                pageNumPending = num;
            } else {
                renderPage(num);
            }
        }

        // Navigation
        document.getElementById('prev').addEventListener('click', () => {
            if (pageNum <= 1) return;
            pageNum--;
            queueRenderPage(pageNum);
        });

        document.getElementById('next').addEventListener('click', () => {
            if (pageNum >= pdfDoc.numPages) return;
            pageNum++;
            queueRenderPage(pageNum);
        });

        // Zoom Controls
        document.getElementById('zoomIn').addEventListener('click', () => {
            scale += 0.25;
            queueRenderPage(pageNum);
        });

        document.getElementById('zoomOut').addEventListener('click', () => {
            if (scale <= 0.25) return;
            scale -= 0.25;
            queueRenderPage(pageNum);
        });

        document.getElementById('zoomLevel').addEventListener('change', (e) => {
            scale = parseFloat(e.target.value);
            queueRenderPage(pageNum);
        });

        // Touch Gestures for Mobile
        let touchStartX = 0;
        viewerContainer.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });

        viewerContainer.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const diffX = touchStartX - touchEndX;
            if (Math.abs(diffX) > 50) { // Swipe threshold
                if (diffX > 0 && pageNum < pdfDoc.numPages) {
                    pageNum++;
                    queueRenderPage(pageNum);
                } else if (diffX < 0 && pageNum > 1) {
                    pageNum--;
                    queueRenderPage(pageNum);
                }
            }
        });

        // Pinch-to-Zoom
        let initialDistance = 0;
        viewerContainer.addEventListener('touchmove', (e) => {
            if (e.touches.length === 2) {
                e.preventDefault();
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const distance = Math.hypot(
                    touch1.clientX - touch2.clientX,
                    touch1.clientY - touch2.clientY
                );
                if (initialDistance === 0) {
                    initialDistance = distance;
                } else {
                    const zoomChange = distance / initialDistance;
                    scale *= zoomChange;
                    scale = Math.max(0.25, Math.min(scale, 3)); // Limit zoom range
                    queueRenderPage(pageNum);
                    initialDistance = distance;
                }
            }
        });

        viewerContainer.addEventListener('touchend', () => {
            initialDistance = 0;
        });
    </script>
</body>
</html>
